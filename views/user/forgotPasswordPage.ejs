<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BnB Collection - Forgot Password</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
    />
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  </head>

  <body class="bg-gray-100 min-h-screen flex flex-col">
    <%- include('../partials/user/header') %>

    <main class="flex-grow flex items-center justify-center px-4 py-6">
      <div
        class="w-full max-w-md bg-white rounded-lg shadow-lg p-8 border border-gray-200"
      >
        <h2 class="text-center text-xl font-semibold mb-6">Forgot Password</h2>

        <p id="msg" class="text-center text-sm mb-4"></p>

        <form id="forgotForm">
          <div class="mb-4">
            <input
              id="email"
              type="email"
              required
              placeholder="Enter your email"
              class="w-full px-4 py-2 border border-gray-300 rounded focus:outline-none focus:border-gray-400"
            />
          </div>

          <button
            type="submit"
            class="w-full bg-red-600 text-white py-2 rounded hover:bg-red-700 transition"
          >
            Verify Email
          </button>
        </form>
      </div>
    </main>

    <%- include("../partials/user/footer") %>

    <script>
      const form = document.getElementById("forgotForm");
      const msg = document.getElementById("msg");

      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        const email = document.getElementById("email").value;

        try {
          const res = await axios.post("/forgot-password", { email });
          msg.textContent = res.data.message;
          msg.style.color = "green";

          if (res.data.success) {
            setTimeout(() => {
              window.location.href = "/forgot-otp";
            }, 1000);
          }
        } catch (err) {
          msg.textContent = err.response?.data?.message || "Server error";
          msg.style.color = "red";
        }
      });
    </script>
  </body>
</html>
